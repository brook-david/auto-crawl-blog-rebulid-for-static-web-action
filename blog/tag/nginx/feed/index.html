<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Nginx &#8211; DB`s Blog</title>
	<atom:link href="https://blog.wanderto.top/tag/nginx/feed/" rel="self" type="application/rss+xml" />
	<link>https://blog.wanderto.top</link>
	<description>随心录</description>
	<lastBuildDate>Thu, 25 Apr 2024 08:03:18 +0000</lastBuildDate>
	<language>zh-CN</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.4.3</generator>

<image>
	<url>https://blog.wanderto.top/wp-content/uploads/2024/04/cropped-logo33-32x32.png</url>
	<title>Nginx &#8211; DB`s Blog</title>
	<link>https://blog.wanderto.top</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>Nginx Ingress域名重定向</title>
		<link>https://blog.wanderto.top/2024/04/22/nginx-ingress-redirect/</link>
					<comments>https://blog.wanderto.top/2024/04/22/nginx-ingress-redirect/#respond</comments>
		
		<dc:creator><![CDATA[DB]]></dc:creator>
		<pubDate>Mon, 22 Apr 2024 05:22:34 +0000</pubDate>
				<category><![CDATA[运维]]></category>
		<category><![CDATA[K8S]]></category>
		<category><![CDATA[Nginx]]></category>
		<guid isPermaLink="false">https://blog.wanderto.top/?p=912</guid>

					<description><![CDATA[<p>前言 由于本站主域名为blog.wanderto.top，但是又希望wanderto.top也能访问本站。多个 [&#8230;]</p>
<p>&lt;p&gt;The post <a rel="nofollow" href="https://blog.wanderto.top/2024/04/22/nginx-ingress-redirect/">Nginx Ingress域名重定向</a> first appeared on <a rel="nofollow" href="https://blog.wanderto.top">DB`s Blog</a>.&lt;/p&gt;</p>
]]></description>
										<content:encoded><![CDATA[
<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group is-vertical is-layout-flex wp-container-core-group-layout-1 wp-block-group-is-layout-flex">
<h2 class="wp-block-heading">前言</h2>



<pre class="wp-block-preformatted">由于本站主域名为blog.wanderto.top，但是又希望wanderto.top也能访问本站。多个域名指向网站不利于SEO，所以采用重定向的方式。本篇文章主要记录两种k8s中Nginx Ingress Controller重定向域名的方法</pre>
</div>



<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained">
<h2 class="wp-block-heading">Permanent Redirect</h2>



<pre class="wp-block-preformatted" style="margin-top:0;margin-bottom:0">redirect主要用于域名重定向，比如访问a.com被重定向到b.com
如下我们配置访问ng.coolops.com重定向到www.baidu.com</pre>



<pre class="EnlighterJSRAW" data-enlighter-language="yaml" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: ingress-nginx
  annotations:
    kubernetes.io/ingress.class: "nginx"
    nginx.ingress.kubernetes.io/permanent-redirect: "https://www.baidu.com"
spec:
  rules:
  - host: ng.coolops.cn 
    http:
      paths:
      - path:
        backend:
          serviceName: ng-svc
          servicePort: 80</pre>



<pre class="wp-block-preformatted" style="margin-top:0;margin-bottom:0">以上参考自：<a href="https://cloud.tencent.com/developer/article/1628571" target="_blank" rel="noreferrer noopener nofollow">https://cloud.tencent.com/developer/article/1628571</a>

按以上这种方式尝试使用nginx.ingress.kubernetes.io/permanent-redirect但是没生效，不知道为什么，我的版本是最新的，应该支持才是。而且我在<a href="https://docs.nginx.com/nginx-ingress-controller" data-type="link" data-id="https://docs.nginx.com/nginx-ingress-controller" target="_blank" rel="noreferrer noopener nofollow">官方文档</a>也没有看到这种方式</pre>



<hr class="wp-block-separator has-alpha-channel-opacity"/>
</div>



<div class="wp-block-group is-layout-constrained wp-block-group-is-layout-constrained">
<h2 class="wp-block-heading">Snippet</h2>



<pre class="wp-block-preformatted" style="margin-top:0;margin-bottom:0">官方文档中有另一种可行的方式，同样是在Ingress中添加一个annotation，不过会复杂点，参考：<a href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" data-type="link" data-id="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" target="_blank" rel="noreferrer noopener">sni</a><a href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" data-type="link" data-id="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" target="_blank" rel="noreferrer noopener nofollow">p</a><a href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" data-type="link" data-id="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" target="_blank" rel="noreferrer noopener">pet</a></pre>



<pre class="EnlighterJSRAW" data-enlighter-language="yaml" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">  annotations:
    nginx.org/server-snippets: |
      if ($host = 'old.example.com') {
        return 301 https://new..example.com;
      }</pre>



<pre class="wp-block-preformatted" style="margin-top:0;margin-bottom:0">通过使用脚本的方式重定向，不过默认是关闭这个功能的，需要开启，参考：<a href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/command-line-arguments#cmdoption-enable-snippets" data-type="link" data-id="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/command-line-arguments#cmdoption-enable-snippets" target="_blank" rel="noreferrer noopener nofollow">相关文档</a></pre>



<hr class="wp-block-separator has-alpha-channel-opacity"/>
</div>
</div>


<p>&lt;p&gt;The post <a rel="nofollow" href="https://blog.wanderto.top/2024/04/22/nginx-ingress-redirect/">Nginx Ingress域名重定向</a> first appeared on <a rel="nofollow" href="https://blog.wanderto.top">DB`s Blog</a>.&lt;/p&gt;</p>
]]></content:encoded>
					
					<wfw:commentRss>https://blog.wanderto.top/2024/04/22/nginx-ingress-redirect/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
	</channel>
</rss>
